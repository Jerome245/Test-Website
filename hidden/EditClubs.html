<!DOCTYPE html>
<html>
	<head>
		<title id="titlee"></title>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1">
		<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
		<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
	</head>
	<script>
		var club = "";
		
		function clubChange(){
		    club = document.getElementById('selectclubs').value;
		    loadTable();
		}
		
		function sendConfirm(type, name){
		    return confirm("Are you sure you wish to " + type + " the club " + name);
		}
		
		function createClub(){
		    var clubname = document.getElementById('nameclub').value;
		    if(clubname != ""){
    		    if(sendConfirm("create",clubname)){
        		    $.ajax({
            			url : 'editclublist',
            			type : 'POST',
            			data : {type: "Create", club: clubname},
            			success : function(data) {
            				if (data == "Error"){
            					alert("Club Creation Failed");
            				}
            				else{
            					alert("Club " + clubname + " is now created");
            					loadTable();
            					document.getElementById('nameclub').value = "";
            				}
            			},
            			error : function(request,error){
            				console.log("Request: "+ error + "\n" + request);
            			} ,
            		    timeout: 5000
    			    });
                }
		    }
		    else{
		        alert("Club name is empty");
		    }
		}
		
		function deleteClub(){
		    var clubname = document.getElementById('selectclubs1').value;
		        if(sendConfirm("delete",clubname)){
    		        $.ajax({
        				url : 'editclublist',
        				type : 'POST',
        				data : {type: "Delete", club: clubname},
        				success : function(data) {
        					if (data == "Error"){
        						alert("Club Deletion Failed");
        					}
        					else{
        						alert("Club " + clubname + " is now deleted");
        						loadTable();
        					}
        				},
        				error : function(request,error){
        					console.log("Request: "+ error + "\n" + request);
        				} ,
        				timeout: 5000
			        });
    		    }
		}
		
		function eraseClub(){
		    var clubname = document.getElementById('selectclubs2').value;
		        if(sendConfirm("empty",clubname)){
    		        $.ajax({
        				url : 'editclublist',
        				type : 'POST',
        				data : {type: "Empty", club: clubname},
        				success : function(data) {
        					if (data == "Error"){
        						alert("Club Deletion Failed");
        					}
        					else{
        						alert("Club " + clubname + " is now empty");
        						loadTable();
        					}
        				},
        				error : function(request,error){
        					console.log("Request: "+ error + "\n" + request);
        				} ,
        				timeout: 5000
			        });
    		    }
		}
		
		function loadTable(){
		    $.ajax({
				url : 'getclubs',
				type : 'POST',
				success : function(data) {
					if (data == "Error"){
						document.getElementById('selectclubs1').innerHTML = "";
						document.getElementById('selectclubs2').innerHTML = "";
					}
					else{
						data = JSON.parse(data);
						var output = "";
						for (var q = 0; q != data.length; q++) {   
							output+="<option>" + data[q][0] + "</option>";
						}
						document.getElementById('selectclubs1').innerHTML = output;
						document.getElementById('selectclubs2').innerHTML = output;
					}
				},
				error : function(request,error){
					console.log("Request: "+ error + "\n" + request);
					document.getElementById('selectclubs').value = club;
				} ,
				timeout: 5000
			});
		}
	</script>
	<body onload = "loadTable()">
		 <nav class="navbar navbar-expand-md bg-dark navbar-dark" id="navv">
			<a class="navbar-brand" href="#">
				<img src="http://wvc.pshs.edu.ph/images/banners/1200px-Philippine_Science_High_School_Main_Campus_Logo_2012.svg.png" alt="Logo" style="width:40px;">
				PSHS-CLC Clubs
			</a>

			<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#collapsibleNavbar">
				<span class="navbar-toggler-icon"></span>
			</button>

			<div class="collapse navbar-collapse" id="collapsibleNavbar">
				<ul class="navbar-nav">
					<li class="nav-item">
						<h4 style="color:white">EditClubs</h4>
					</li>
				</ul>
			</div>
		</nav>
		<br><br>
		    <div class="row justify-content-center">
				<div class="col-sm-10 ">
					<h3>Create New Club:</h3>
				</div>
			</div>
		    <div class="row justify-content-center">
		        <div class="col-sm-1">
                    <label for="usr">Club Name:</label>
				</div>
				<div class="col-sm-8" style="padding-right:0;padding-left:0; ">
                    <input type="text" class="form-control" id="nameclub">
				</div>
				<div class="col-sm-1">
                    <button type="button" class="btn" style="margin-left:auto;margin-right:auto" onclick="createClub()">Go & Run</button>
				</div>
			</div>
			<br><br>
			<div class="row justify-content-center">
				<div class="col-sm-10 ">
					<h3>Delete Club:</h3>
				</div>
			</div>
			<div class="row justify-content-center">
			    <div class="col-sm-1">
                    <label for="usr">Club Name:</label>
				</div>
				<div class="col-sm-8" style="padding-right:0;padding-left:0; ">
                    <select id="selectclubs1" style="width:100%" onchange="clubChange()"></select>
				</div>
				<div class="col-sm-1">
                    <button type="button" class="btn" style="margin-left:auto;margin-right:auto" onclick="deleteClub()">Go & Run</button>
				</div>
			</div>
			<br><br>
			<div class="row justify-content-center">
				<div class="col-sm-10 ">
					<h3>Empty Club:</h3>
				</div>
			</div>
	        <div class="row justify-content-center">
				<div class="col-sm-1">
                    <label for="usr">Club Name:</label>
				</div>
				<div class="col-sm-8" style="padding-right:0;padding-left:0; ">
                    <select id="selectclubs2" style="width:100%" onchange="clubChange()"></select>
				</div>
				<div class="col-sm-1">
                    <button type="button" class="btn" style="margin-left:auto;margin-right:auto" onclick="eraseClub()">Go & Run</button>
				</div>
			</div>
	</body>
</html>